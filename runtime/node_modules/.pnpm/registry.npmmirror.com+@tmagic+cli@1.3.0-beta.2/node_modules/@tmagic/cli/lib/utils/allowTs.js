"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.allowTs = exports.transformTsFileToCodeSync = void 0;
const tslib_1 = require("tslib");
const esbuild_1 = require("esbuild");
const fs_extra_1 = tslib_1.__importDefault(require("fs-extra"));
/**
 * Transform a ts file to cjs code
 */
const transformTsFileToCodeSync = (filename) => (0, esbuild_1.transformSync)(fs_extra_1.default.readFileSync(filename).toString(), {
    format: 'cjs',
    loader: 'ts',
    sourcefile: filename,
    sourcemap: 'inline',
    target: 'node14',
}).code;
exports.transformTsFileToCodeSync = transformTsFileToCodeSync;
/**
 * Globally allow ts files to be loaded via `require()`
 */
const allowTs = () => {
    require.extensions['.ts'] = (m, filename) => {
        m._compile((0, exports.transformTsFileToCodeSync)(filename), filename);
    };
};
exports.allowTs = allowTs;
//# sourceMappingURL=allowTs.js.map